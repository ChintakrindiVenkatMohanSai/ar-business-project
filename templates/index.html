<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mobile AR Viewer</title>

<script type="module"
src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
</script>

<style>
body{
 margin:0;
 background:black;
 color:white;
 text-align:center;
 font-family:Arial;
}

h2{
 padding:15px;
}

model-viewer{
 width:100%;
 height:80vh;
 background:black;
}

button{
 padding:10px 18px;
 margin:8px;
 border:none;
 border-radius:8px;
 background:#00c3ff;
 color:white;
 font-size:16px;
}
</style>
</head>

<body>

<h2>ğŸ“± View 3D Model in Your Room</h2>

{% for p in products %}
<div class="product">

<h2>{{p[1]}}</h2>

<model-viewer
 id="mv{{loop.index}}"
 src="/uploads/{{p[2]}}"
 ar
 ar-modes="webxr scene-viewer quick-look"
 camera-controls
 touch-action="pan-y"
 interaction-prompt="auto"
 exposure="1"
 shadow-intensity="1"
 environment-image="neutral"
 style="width:100%;height:400px;background:black;">

<button slot="ar-button">
View in AR ğŸš€
</button>

</model-viewer>

<br>

<button onclick="rotateX('mv{{loop.index}}',-20)">â¬†ï¸ Up</button>
<button onclick="rotateX('mv{{loop.index}}',20)">â¬‡ï¸ Down</button>
<button onclick="rotateY('mv{{loop.index}}',-20)">â¬…ï¸ Left</button>
<button onclick="rotateY('mv{{loop.index}}',20)">â¡ï¸ Right</button>
<button onclick="resetRotation('mv{{loop.index}}')">Reset ğŸ”„</button>

</div>
{% endfor %}

<script>
let rotations={};

function update(id){
 let r = rotations[id];
 document.getElementById(id).orientation =
   `${r.x}deg ${r.y}deg ${r.z}deg`;
}

function rotateX(id,val){
 if(!rotations[id]) rotations[id]={x:0,y:0,z:0};
 rotations[id].x+=val;
 update(id);
}

function rotateY(id,val){
 if(!rotations[id]) rotations[id]={x:0,y:0,z:0};
 rotations[id].y+=val;
 update(id);
}

function resetRotation(id){
 rotations[id]={x:0,y:0,z:0};
 update(id);
}
</script>

</body>
</html>
